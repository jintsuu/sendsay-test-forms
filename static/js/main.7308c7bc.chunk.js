(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(7),i=a.n(r),l=a(1),o=a(2),c=a(4),u=a(3),m=a(5),d=a(8),p=a.n(d),f=function(e){var t=e.buttonCounter,a=e.addFile,n=e.deleteFile,r=e.index;return s.a.createElement("div",{className:"file-input-wrapper",id:"button-".concat(r)},s.a.createElement("input",{className:"file-input",type:"file",id:"file-".concat(r),onChange:function(e){return a(e.target.files[0])}}),s.a.createElement("label",{htmlFor:"file-".concat(r),className:"file-label",id:"label-".concat(r)},"Add some file into me!"),s.a.createElement("img",{src:p.a,alt:"Delete",className:t===r?"disabled":"delete-btn",onClick:function(){return n(r)}}))},h=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getStatus=function(e){var t,n="Sending",s=!1,r={action:"track.get",id:e,session:a.props.session},i="apiversion=100&json=1&request="+encodeURIComponent(JSON.stringify(r));fetch("https://api.sendsay.ru/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(function(e){return e.json()}).then(function(e){t=e.obj.status,-1===(t=Number(t))?(n="Sended",s=!0):t<-1&&(n="Error",s=!0),s&&clearInterval(a.interval),a.setState({status:n,isStatusSetted:s})}).catch(function(e){return console.log(e)})},a.state={status:"Sending",isStatusSetted:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return e.getStatus(e.props.trackId)},2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this.props,t=e.date,a=e.subject,n=this.state.status;return s.a.createElement("div",{className:"messages__item"},s.a.createElement("p",{className:"item__date"},t),s.a.createElement("p",{className:"item__subject"},a),s.a.createElement("p",{className:"item__status ".concat(n)},n))}}]),t}(n.Component),g=function(e){var t=e.isMessagesSended,a=e.messages,n=e.session;return s.a.createElement("div",{className:t?"messages-box":"disabled"},s.a.createElement("div",{className:"messages-box__wrapper"},s.a.createElement("ul",{className:"messages-box__titles"},s.a.createElement("li",{className:"titles__item"},"Date"),s.a.createElement("li",{className:"titles__item"},"Subject"),s.a.createElement("li",{className:"titles__item"},"Status")),s.a.createElement("hr",null),s.a.createElement("div",{className:"messages"},a.reverse().map(function(e,t){return s.a.createElement(h,{trackId:e.id,session:n,date:e.date,subject:e.subject,key:t})}))))},v=(a(15),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).dropRef=s.a.createRef(),e.handleDrag=function(e){e.preventDefault(),e.stopPropagation()},e.handleDragIn=function(t){t.preventDefault(),t.stopPropagation(),e.dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0&&e.setState({dragging:!0})},e.handleDragOut=function(t){t.preventDefault(),t.stopPropagation(),e.dragCounter--,0===e.dragCounter&&e.setState({dragging:!1})},e.handleDrop=function(t){t.preventDefault(),t.stopPropagation(),e.setState({dragging:!1});var a=t.dataTransfer.files;if(a&&a.length>0)for(var n=0,s=a.length;n<s;n++)e.addFile(a[n])},e.addButtonsIntoArr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=e.state.buttons;a.push({component:"",number:t}),e.setState({buttons:a})},e.addFile=function(t){var a,n=e.state.buttonCounter,s=e.state.sizes,r=t.size/1024/1024,i=r+e.state.sizeSum,l=document.getElementById("label-".concat(n)),o=document.getElementById("file-".concat(n)),c=new FileReader;r<5&&i<20?(o.setAttribute("disabled",""),c.onload=function(s){a=s.target.result,e.state.files.push({file:{name:t.name,content:a,encoding:"base64"},number:n})},c.readAsDataURL(t),l.innerHTML=t.name,n++,s.push({size:r,number:n}),e.setState({buttonCounter:n,sizeSum:i,sizes:s},function(){return e.addButtonsIntoArr(n)})):r>5?(alert("Size of file too large!"),o.value=""):i>20&&(alert("Sum of file's sizes too large!"),o.value="")},e.deleteFile=function(t){var a,n=e.state.buttons,s=e.state.files,r=e.state.sizes;s=s.filter(function(e){return e.number!==t+1}),n=n.filter(function(e){return e.number!==t}),a=(r=r.filter(function(e){return e.number!==t+1})).reduce(function(e,t){return e+t.size},0),e.setState({files:s,sizeSum:a,sizes:r,buttons:n})},e.auth=function(t){t.preventDefault();var a="apiversion=100&json=1&request="+encodeURIComponent(JSON.stringify({action:"login",login:"nipanasovich@gmail.com",passwd:"uu1Quem"})),n=e.state.session;fetch("https://api.sendsay.ru/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a}).then(function(e){return e.json()}).then(function(t){n=t.session,e.setState({session:n}),e.sendMail()}).catch(function(e){return console.log(e)})},e.sendMail=function(t){e.state.isAuth&&t.preventDefault();var a,n=document.getElementById("fromName"),s=document.getElementById("fromMail"),r=document.getElementById("toName"),i=document.getElementById("toMail"),l=document.getElementById("subject"),o=document.getElementById("text"),c=[],u=e.state.files,m=new Date,d="".concat(m.getDate()," ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][m.getMonth()]," ").concat(m.getFullYear()," ").concat(m.getHours(),":").concat(m.getMinutes(),":").concat(m.getSeconds()),p=e.state.messages;u.forEach(function(e){c.push(e.file)});var f={action:"issue.send.test",letter:{subject:l.value,"from.name":n.value,"from.email":s.value,"to.name":r.value,message:{text:o.value},attaches:c},sendwhen:"test",mca:[i.value],session:e.state.session},h="apiversion=100&json=1&request="+encodeURIComponent(JSON.stringify(f));fetch("https://api.sendsay.ru/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:h}).then(function(e){return e.json()}).then(function(t){a=t["track.id"];var c={subject:l.value,fromName:n.value,fromMail:s.value,toName:r.value,toMail:i.value,text:o.value,date:d,id:a};p.push(c),n.value="",s.value="",r.value="",i.value="",l.value="",o.value="",e.setState({messages:p,isMessagesSended:!0,isAuth:!0,sizeSum:0,buttonCounter:1,files:[],sizes:[],buttons:[]},function(){return e.addButtonsIntoArr()})}).catch(function(e){return console.log(e)})},e.state={buttonCounter:1,sizeSum:0,sizes:[],buttons:[],files:[],dragging:!1,messages:[],isMessagesSended:!1,session:"",isAuth:!1},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.dragCounter=0;var e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop),this.addButtonsIntoArr()}},{key:"componentWillUnmount",value:function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}},{key:"render",value:function(){var e=this,t=this.state,a=t.isAuth,n=t.buttonCounter,r=t.dragging,i=t.sizeSum,l=t.isMessagesSended,o=t.messages,c=t.buttons,u=t.session;return s.a.createElement("div",{className:"App"},s.a.createElement("form",{onSubmit:a?this.sendMail:this.auth,className:"form",ref:this.dropRef},s.a.createElement("div",{className:r?"drop-zone":"disabled"},s.a.createElement("div",{className:"drop-zone--inner"},s.a.createElement("p",{className:"drop-zone__text"},"Drop me Here!"))),s.a.createElement("h1",{className:"form__heading"},"BestMail"),s.a.createElement("div",{className:"form__inputs"},s.a.createElement("div",{className:"input-wrapper"},s.a.createElement("input",{className:"input",type:"text",id:"fromName",name:"from-name",minLength:"2",maxLength:"30",placeholder:"Your Name",required:!0}),s.a.createElement("label",{htmlFor:"from-name",className:"label"},"Your Name")),s.a.createElement("div",{className:"input-wrapper"},s.a.createElement("input",{className:"input",type:"email",id:"fromMail",name:"from-mail",placeholder:"Your Email",required:!0}),s.a.createElement("label",{htmlFor:"from-name",className:"label"},"Your Email")),s.a.createElement("div",{className:"input-wrapper"},s.a.createElement("input",{className:"input",type:"text",id:"toName",name:"to-name",minLength:"2",maxLength:"30",placeholder:"Receiver Name",required:!0}),s.a.createElement("label",{htmlFor:"from-name",className:"label"},"Receiver Name")),s.a.createElement("div",{className:"input-wrapper"},s.a.createElement("input",{className:"input",type:"email",id:"toMail",name:"to-mail",placeholder:"Receiver Email",required:!0}),s.a.createElement("label",{htmlFor:"from-name",className:"label"},"Receiver Email")),s.a.createElement("div",{className:"input-wrapper input--subject"},s.a.createElement("input",{className:"input",type:"text",id:"subject",name:"subject",minLength:"4",placeholder:"Message Subject",required:!0}),s.a.createElement("label",{htmlFor:"subject",className:"label"},"Message Subject"))),s.a.createElement("textarea",{className:"textarea",id:"text",rows:"7",placeholder:"Write your message here!",minLength:"10",required:!0}),s.a.createElement("div",{className:"files"},c.map(function(t){return t.component=s.a.createElement(f,{buttonCounter:n,index:t.number,key:t.number,addFile:e.addFile,deleteFile:e.deleteFile}),t.component})),s.a.createElement("div",{className:"files-size"},s.a.createElement("p",null,"Total size of files: ",i," MB"),s.a.createElement("p",null,"Max size of one file: 5 MB"),s.a.createElement("p",null,"Max size of all files: 20 MB")),s.a.createElement("input",{type:"submit",className:"submit-btn",value:"Send!"})),s.a.createElement(g,{isMessagesSended:l,messages:o,session:u}))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},8:function(e,t,a){e.exports=a.p+"static/media/del.fd8b42e2.svg"},9:function(e,t,a){e.exports=a(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.7308c7bc.chunk.js.map